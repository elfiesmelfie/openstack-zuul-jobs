- job:
    name: openstack-doc-build
    parent: tox-docs
    run: playbooks/tox/docs
    roles:
      - zuul: openstack-infra/openstack-zuul-jobs

- job:
    name: tox-py35-on-zuul
    parent: tox-py35
    description: |
      Run zuul's py35 unittests on patches to zuul-jobs
    vars:
      zuul_work_dir: "src/git.openstack.org/openstack-infra/zuul"
    required-projects:
      - name: openstack-infra/zuul
        override-branch: feature/zuulv3

- job:
    name: tox-py35-constraints
    parent: tox-py35
    description: |
      Run zuul's tox 'py35' job but with OpenStack requirements constraints
    required-projects:
      - name: openstack/requirements
    vars:
      tox_environment:
        UPPER_CONSTRAINTS_FILE: "{{ ansible_user_dir }}/src/git.openstack.org/openstack/requirements/upper-constraints.txt"

- job:
    name: publish-openstack-python-tarball
    parent: publish-openstack-artifacts
    description: |
      Publish the results of the tox-tarball job to tarballs.openstack.org.
    pre-run: playbooks/python-tarball/pre
    run: playbooks/python-tarball/run
    post-run: playbooks/python-tarball/post

- job:
    name: publish-openstack-python-branch-tarball
    parent: publish-openstack-python-tarball
    description: |
      Publish the results of the tox-tarball job to tarballs.openstack.org.
    post-run: playbooks/python-branch-tarball/post

- project:
    name: openstack-infra/openstack-zuul-jobs
    check:
      jobs:
        - openstack-doc-build
        - tox-linters
    gate:
      jobs:
        - openstack-doc-build
        - tox-linters
